<html lang="ja">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<head>

<script type="text/javascript" src="../../js/lwf.js"></script>
<script type="text/javascript">

// * The "window.onload" is called by web browser
window.onload = function() {
    // * Create a stage for LWF
    var stage = document.createElement("canvas");
    stage.width = 0;
    stage.height = 0;
    document.body.appendChild(stage);

    // * "LWF" has been initialized and accessible fby using LWF.
    // * Renderer should be declared 
    LWF.useCanvasRenderer();
    
    // * Get resource cache
    cache = LWF.ResourceCache.get();
        
    cache.loadLWF({
        "lwf": "gree_logo.lwf",    // *.lwf file name
        "prefix": "../../flash/gree_logo.lwfdata/", // * lwf, png folder
        "stage": stage, // * target stage
        "onload": function(lwf) {
             window.gree_icon_lwf = lwf;
        }, // * function that will be called on load
    });
    
    cache.loadLWF({
        "lwf": "animated_building.lwf",    // *.lwf file name
        "prefix": "../../flash/animated_building.lwfdata/", // * lwf, png folder
        "stage": stage, // * target stage
        "onload": function(lwf) {
             window.house_lwf = lwf;
        }, // * function that will be called on load
    });
};


// * Main loop preparation
window.requestAnimationFrame = (function() {
    return  window.requestAnimationFrame       ||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame    ||
            window.oRequestAnimationFrame      ||
            window.msRequestAnimationFrame     ||
            function(/* function */ callback, /* DOMElement */ element) {
              window.setTimeout(callback, 1000 / 60);
            };
})();


function main() {
    window.requestAnimationFrame(main); 

    if (window.gree_icon_lwf != null) {
        // * Evaluate lwf and render it 
        window.gree_icon_lwf.exec(calc_tick());
        window.gree_icon_lwf.render();      
    }
}
main();

// * 
var current_time, from_time
function calc_tick() {
    current_time =  Date.now() / 1000.0;
    tick = current_time - from_time;
    from_time = current_time;
    return tick
}


function attach_lwf() {
    new_movie = window.gree_icon_lwf.rootMovie.attachLWF(window.house_lwf, "house_lwf", {"depth": 1})
}

//
</script>
</head>
<body>
<a href="javascript:attach_lwf()"> Attach LWF </a>
</body>
</html>
